// prisma:engineType = "binary"

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  // ❗️ REMOVE the URL — Prisma 7 forbids it here
}

model Run {
  id            Int          @id @default(autoincrement())
  keyword       String
  markupPercent Float
  source        String
  status        String
  createdCount  Int          @default(0)
  errorMessage  String?
  startedAt     DateTime     @default(now())
  finishedAt    DateTime?

  products      ProductLog[]
}

model ProductLog {
  id               Int      @id @default(autoincrement())
  run              Run      @relation(fields: [runId], references: [id], onDelete: Cascade)
  runId            Int

  asin             String?
  title            String
  sourcePrice      Float?
  finalPrice       Float?
  currency         String   @default("USD")
  shopifyProductId String?
  shopifyHandle    String?

  oldPrice         Float?
  updatedPrice     Float?
  stockStatus      String?
  profitAtSale     Float?

  createdAt        DateTime @default(now())
}

model SyncedVariant {
  id               Int      @id @default(autoincrement())
  asin             String?
  sku              String?
  source           String?
  shopifyProductId String
  shopifyVariantId String

  currentPrice     Float?
  lastCostPrice    Float?
  inStock          Boolean  @default(true)

  lastCheckedAt    DateTime @updatedAt
  createdAt        DateTime @default(now())
  deleted          Boolean  @default(false)
}
